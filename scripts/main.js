function p(){({types:["light","dark","auto"],currentType:"auto",icons:{light:"icon-sun",dark:"icon-moon",auto:"icon-auto"},toggle(){let n=(this.types.indexOf(this.currentType)+1)%this.types.length;this.currentType=this.types[n],this.apply(),localStorage.setItem("theme",this.currentType),this.updateIcon()},apply(){let e=document.documentElement;if(this.types.forEach(n=>{e.classList.remove(n)}),this.currentType==="auto"){let i=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";e.classList.add(i)}else e.classList.add(this.currentType)},updateIcon(){let e=document.getElementById("themeIcon");e&&(e.className=`iconfont ${this.icons[this.currentType]}`)},init(){let e=localStorage.getItem("theme");e&&this.types.includes(e)&&(this.currentType=e),this.apply(),this.updateIcon(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{this.currentType==="auto"&&this.apply()});let n=document.getElementById("themeToggle");n&&n.addEventListener("click",()=>this.toggle())}}).init()}function f(){({toggle(){let e=document.getElementById("mobileMenu");e&&(e.style.display=e.style.display==="none"?"block":"none")},init(){let e=document.querySelector(".nav-btn.mobile");e&&e.addEventListener("click",()=>this.toggle());let n=document.querySelector(".mobile-menu .close-control"),i=document.querySelector(".mobile-menu .menu-mask");n&&n.addEventListener("click",()=>this.toggle()),i&&i.addEventListener("click",()=>this.toggle())}}).init()}function y(){if(typeof Fancybox>"u"){console.error("Fancybox \u521D\u59CB\u5316\u5F02\u5E38");return}Fancybox.bind("[data-fancybox]",{hideScrollbar:!0,Carousel:{transition:"slide"},Hash:!1,Toolbar:{display:{left:["infobar"],middle:["zoomIn","zoomOut","toggle1to1","rotateCCW","rotateCW","flipX","flipY"],right:["slideshow","thumbs","close"]}},l10n:{PANUP:"\u4E0A\u79FB",PANDOWN:"\u4E0B\u79FB",PANLEFT:"\u5DE6\u79FB",PANRIGHT:"\u53F3\u79FB",ZOOMIN:"\u653E\u5927",ZOOMOUT:"\u7F29\u5C0F",TOGGLEZOOM:"\u5207\u6362\u7F29\u653E\u7EA7\u522B",TOGGLE1TO1:"\u5207\u6362\u7F29\u653E\u7EA7\u522B",ITERATEZOOM:"\u5207\u6362\u7F29\u653E\u7EA7\u522B",ROTATECCW:"\u9006\u65F6\u9488\u65CB\u8F6C",ROTATECW:"\u987A\u65F6\u9488\u65CB\u8F6C",FLIPX:"\u6C34\u5E73\u7FFB\u8F6C",FLIPY:"\u5782\u76F4\u7FFB\u8F6C",FITX:"\u6C34\u5E73\u9002\u5E94",FITY:"\u5782\u76F4\u9002\u5E94",RESET:"\u91CD\u7F6E",TOGGLEFS:"\u5207\u6362\u5168\u5C4F",CLOSE:"\u5173\u95ED",NEXT:"\u4E0B\u4E00\u4E2A",PREV:"\u4E0A\u4E00\u4E2A",MODAL:"\u4F7F\u7528 ESC \u952E\u5173\u95ED",ERROR:"\u53D1\u751F\u4E86\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5",IMAGE_ERROR:"\u627E\u4E0D\u5230\u56FE\u50CF",ELEMENT_NOT_FOUND:"\u627E\u4E0D\u5230 HTML \u5143\u7D20",AJAX_NOT_FOUND:"\u8F7D\u5165 AJAX \u65F6\u51FA\u9519: \u672A\u627E\u5230",AJAX_FORBIDDEN:"\u8F7D\u5165 AJAX \u65F6\u51FA\u9519: \u88AB\u963B\u6B62",IFRAME_ERROR:"\u52A0\u8F7D\u9875\u9762\u51FA\u9519",TOGGLE_ZOOM:"\u5207\u6362\u7F29\u653E\u7EA7\u522B",TOGGLE_THUMBS:"\u5207\u6362\u7F29\u7565\u56FE",TOGGLE_SLIDESHOW:"\u5207\u6362\u5E7B\u706F\u7247",TOGGLE_FULLSCREEN:"\u5207\u6362\u5168\u5C4F",DOWNLOAD:"\u4E0B\u8F7D"}})}var g={searchData:[],searchOptions:{keys:["title","content"]},fuse:null,toggleSearch(){window.$Modal.isVisible("search-modal")?window.$Modal.hide("search-modal"):(window.$Modal.show("search-modal"),document.getElementById("search-input").focus())},search(t){let e=document.querySelector(".search-list"),n=document.querySelector(".search-empty"),i=document.querySelector("#search-hint-text"),r=performance.now(),o=this.fuse.search(t);o.length===0?(e.style.display="none",n.style.display="flex"):(e.style.display="block",n.style.display="none",e.innerHTML=o.map(c=>c.item).map(c=>`
                <div class="search-item" onclick="window.location.href='${c.permalink}'">
                    <div class="search-item-title">${this.highlightKeyword(c.title,t)}</div>
                    <div class="search-item-content">${this.highlightKeyword(this.truncateContent(c.content,t),t)}</div>
                </div>
            `).join(""));let s=performance.now();i.innerHTML=`\u672C\u6B21\u7528\u65F6 ${Math.round(s-r)} \u6BEB\u79D2`},highlightKeyword(t,e){if(!e)return t;let n=new RegExp(e,"gi");return t.replace(n,i=>`<mark>${i}</mark>`)},truncateContent(t,e,n=200){if(t.length<=n)return t;if(e){let i=t.toLowerCase().indexOf(e.toLowerCase());if(i!==-1){let r=Math.max(0,i-Math.floor((n-e.length)/2)),o=Math.min(t.length,r+n);return t.substring(r,o)+"..."}}return t.substring(0,n)+"..."},init(){this.reset(),document.getElementById("search-input").addEventListener("input",e=>{let n=e.target.value.trim();n||this.reset(),this.search(n)});let t=document.querySelector('.nav-btn[title="\u5168\u7AD9\u641C\u7D22"]');t&&t.addEventListener("click",()=>this.toggleSearch()),fetch("/index.json.gz").then(e=>e.arrayBuffer()).then(e=>window.pako.inflate(new Uint8Array(e),{to:"string"})).then(e=>JSON.parse(e)).then(e=>{this.searchData=e,this.fuse=new Fuse(this.searchData,this.searchOptions)})},reset(){let t=document.querySelector(".search-list"),e=document.querySelector(".search-empty"),n=document.querySelector("#search-hint-text");n.innerHTML="",t.innerHTML="",t.style.display="none",e.style.display="flex"}};window.$Search=g;function v(){g.init()}function I(t,e){let n=null,i=0;return function(){let r=Date.now(),o=e-(r-i);o<=0||o>e?(n&&(clearTimeout(n),n=null),i=r,t.apply(this,arguments)):n||(n=setTimeout(()=>{i=Date.now(),n=null,t.apply(this,arguments)},o))}}function m(){let t=document.querySelector(".main-nav"),e=document.querySelector(".to-top"),n=document.querySelector(".to-top .num"),i=window.scrollY||window.pageYOffset,r=document.documentElement.scrollHeight-window.innerHeight,o=(i/r*100).toFixed(0);i===0?t.classList.add("top"):t.classList.remove("top");let s=i>(m.lastScrollY||0)?"down":"up";m.lastScrollY=i,t.classList.remove("up","down"),t.classList.add(s),i===0?e.classList.add("hidden"):e.classList.remove("hidden"),n&&(n.textContent=o),o>90?(n.textContent="\u8FD4\u56DE\u9876\u90E8",e.classList.add("long")):e.classList.remove("long")}function E(){window.scrollTo({top:0,behavior:"smooth"})}function w(){m(),window.addEventListener("scroll",I(m,300));let t=document.querySelector(".to-top");t&&t.addEventListener("click",E);let e=document.querySelector(".site-title");e&&e.addEventListener("click",E)}function x(){let t=document.getElementById("next-post"),e=document.getElementById("page-content");if(!t||!e)return;let n=null,i=t.getAttribute("data-is-next")==="true",r=!1,o=()=>{n&&n.disconnect(),n=new IntersectionObserver(a=>{a.forEach(l=>{r=!l.isIntersecting,s()})}),n.observe(e)},s=()=>{r?(t.classList.add("fixed","show"),t.style.transform="translateY(0)"):(t.classList.remove("show"),i?t.style.transform="translateY(180px)":t.style.transform="translateY(-180px)")},c=t.querySelector(".next-post-link");return c&&c.addEventListener("click",a=>{a.preventDefault();let l=c.getAttribute("href");l&&(t.style.opacity="0",t.style.transform=i?"translateY(180px)":"translateY(-180px)",setTimeout(()=>{window.location.href=l},300))}),o(),()=>{n&&n.disconnect()}}var T={modals:new Map,init(){document.querySelectorAll(".modal").forEach(t=>{let e=t.id;if(!e){console.error("Modal element must have an id!");return}let n={element:t,mask:t.querySelector(".modal-mask"),closeBtn:t.querySelector(".close"),isVisible:!1};n.mask?.addEventListener("click",()=>this.hide(e)),n.closeBtn?.addEventListener("click",()=>this.hide(e)),this.modals.set(e,n)}),document.addEventListener("keydown",t=>{t.key==="Escape"&&this.modals.forEach((e,n)=>{e.isVisible&&this.hide(n)})})},show(t){let e=this.modals.get(t);if(!e){console.error(`Modal with id "${t}" not found!`);return}e.element.style.display="flex",document.body.style.overflowY="hidden",e.isVisible=!0,requestAnimationFrame(()=>{e.element.classList.add("show")})},hide(t){let e=this.modals.get(t);if(!e){console.error(`Modal with id "${t}" not found!`);return}e.element.classList.remove("show"),setTimeout(()=>{e.element.style.display="none",document.body.style.overflowY="",e.isVisible=!1},300)},isVisible(t){return this.modals.get(t)?.isVisible||!1}};window.$Modal=T;function L(){T.init()}function S(){hljs.highlightAll(),document.querySelectorAll("pre > code").forEach(t=>{let e=t.parentElement,n=document.createElement("div");n.className="highlight",e.parentNode.insertBefore(n,e);let i=t.getAttribute("data-lang")||t.className.match(/language-(\w+)/)?.[1]||"plaintext",r=document.createElement("div");r.className="highlight-header";let o=document.createElement("div");o.className="highlight-info";let s=document.createElement("span");s.className="highlight-lang",s.textContent=i,o.appendChild(s);let c=t.innerHTML.trim().split(`
`),a=document.createElement("span");a.textContent=`${c.length} \u884C`,a.style.display="none",o.appendChild(a),r.appendChild(o);let l=document.createElement("button");l.className="copy-button",l.textContent="\u590D\u5236",r.appendChild(l);let d=document.createElement("div");d.className="highlight-content";let h=document.createElement("div");h.className="line-numbers",h.innerHTML=c.map((u,A)=>`<span>${A+1}</span>`).join(""),d.appendChild(h),d.appendChild(e),n.appendChild(r),n.appendChild(d),l.addEventListener("click",async()=>{try{await navigator.clipboard.writeText(t.textContent),l.textContent="\u5DF2\u590D\u5236",l.classList.add("copied"),setTimeout(()=>{l.textContent="\u590D\u5236",l.classList.remove("copied")},2e3)}catch(u){console.error("\u590D\u5236\u5931\u8D25:",u),l.textContent="\u590D\u5236\u5931\u8D25"}})})}function b(){let t=["\u5F88\u9AD8\u5174\u89C1\u5230\u4F60","\u597D\u4E45\u4E0D\u89C1","\u6B22\u8FCE\u56DE\u6765","\u4ECA\u65E5\u5B9C\u996E\u9152\u8D4F\u6708","\u4ECA\u5929\u7684\u4E91\u6735\u548C\u4F60\u4E00\u6837\u53EF\u7231","\u4ECA\u5929\u7684\u665A\u971E\u8BB0\u5F97\u5206\u4F60\u4E00\u534A","\u60A8\u7684\u597D\u53CB\u4EB2\u5BC6\u5EA6+10"],e=document.querySelector("#hello-weidget-tip");e&&(e.innerText=t[Math.floor(Math.random()*t.length)])}function M(){let t=document.getElementById("randomToggle");t&&t.addEventListener("click",()=>{fetch("/index.json").then(e=>e.json()).then(e=>{let n=e[Math.floor(Math.random()*e.length)];location.href=n.permalink})})}function C({baseUrl:t,siteId:e}){if(!t||!e)return;let n=`${t.replace(/\/$/,"")}/api/stats/${e}/total`;fetch(n).then(o=>o.json()).then(o=>{o&&o.pageviews&&o.visitors&&(document.querySelectorAll('[id="umami_value_site_pv"]').forEach(s=>{s.textContent=o.pageviews.value}),document.querySelectorAll('[id="umami_value_site_uv"]').forEach(s=>{s.textContent=o.visitors.value}))}).catch(()=>{});let i=`${n}?url=${encodeURIComponent(window.location.pathname)}`;fetch(i).then(o=>o.json()).then(o=>{o&&o.pageviews&&o.visitors&&(document.querySelectorAll('[id="umami_value_page_pv"]').forEach(s=>{s.textContent=o.pageviews.value}),document.querySelectorAll('[id="umami_value_page_uv"]').forEach(s=>{s.textContent=o.visitors.value}))}).catch(()=>{});let r=`${t.replace(/\/$/,"")}/api/stats/${e}/today`;fetch(r).then(o=>o.json()).then(o=>{o&&o.pageviews&&o.visitors&&(document.querySelectorAll('[id="umami_value_current_pv"]').forEach(s=>{s.textContent=o.pageviews.value}),document.querySelectorAll('[id="umami_value_current_uv"]').forEach(s=>{s.textContent=o.visitors.value}))}).catch(()=>{})}function O(t){let e=`${t}/api/comment?type=count&url=${encodeURIComponent(window.location.href)}`;fetch(e).then(n=>n.json()).then(n=>{n&&n.data&&n.data.length>0&&document.querySelectorAll('[id="waline_comments_count"]').forEach(i=>{i.textContent=n.data[0]})}).catch(()=>{})}function N(t){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",t):t()}function _(){p(),f(),y(),v(),w(),x(),L(),S(),b(),M(),C({baseUrl:"https://umami-api.yuanpei.me",siteId:"445bd2eb-68f9-47fd-b93a-5dfa92be333d"}),O("https://waline.yuanpei.me")}N(_);
